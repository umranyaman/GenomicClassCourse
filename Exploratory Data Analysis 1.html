

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Exploratory Data Analysis 1</title>
    
    <meta name="author" content="Rafael Irizarry and Michael Love">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="http://genomicsclass.github.io/book/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="http://genomicsclass.github.io/book/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="http://genomicsclass.github.io/book/assets/themes/twitter/css/kbroman.css" rel="stylesheet" type="text/css" media="all">
    <link href="http://genomicsclass.github.io/book/assets/themes/twitter/css/knitr.css" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
    <link href="http://genomicsclass.github.io/book/assets/themes/twitter/ico/favicon.ico" rel="icon" type="image/png">

    <!-- atom & rss feed -->
    <link href="http://genomicsclass.github.io/booknil" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="http://genomicsclass.github.io/booknil" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

    <!-- knitr javascript -->
    <script src="http://genomicsclass.github.io/book/assets/themes/twitter/knitr.js" type="text/javascript"></script>

    <!-- mathjax javascript -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>

    <script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>


  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="http://genomicsclass.github.io/book">PH525x series - Biomedical Data Science</a>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        

<div class="page-header">
  <h2>Exploratory Data Analysis 1 </h2>
</div>

<div class="row-fluid">
  <div class="span12">
    <h1 id="introduction">Introduction</h1>

<p>Biases, systematic errors and unexpected variability are common in data from the life sciences. Failure to discover these problems often leads to flawed analyses and false discoveries. As an example, consider that experiments sometimes fail and not all data processing pipelines, such as the t.test function in R, are designed to detect these. Yet, these pipelines still give you an answer. Furthermore, it may be hard or impossible to notice an error was made just from the reported results.</p>

<p>Graphing data is a powerful approach to detecting these problems. We refer to this as <em>exploratory data analyis</em> (EDA). Many important methodological contributions to existing data analysis techniques in data analysis were initiated by discoveries made via EDA. Through this book we make use of exploratory plots to motivate the analyses we choose. Here we present a general introduction to EDA using height data.</p>

<p><a name="histograms"></a></p>

<h1 id="histograms">Histograms</h1>

<p>We can think of any given dataset as a list of numbers. Suppose you have measured the heights of all men in a population. Imagine you need to describe these numbers to someone that has no idea what these heights are, for example an alien that has never visited earth.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># install.packages("UsingR")</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">UsingR</span><span class="p">)</span><span class="w">
</span><span class="n">x</span><span class="o">=</span><span class="n">father.son</span><span class="o">$</span><span class="n">fheight</span><span class="w">
</span></code></pre></div></div>
<p>One approach is to simply list out all the numbers for the alien to see. Here are 20 randomly selected heights of 1,078.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">round</span><span class="p">(</span><span class="n">sample</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="m">20</span><span class="p">),</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>##  [1] 70.6 70.2 71.0 67.4 62.0 70.5 69.9 67.2 64.6 69.0 68.0 72.5 66.7 70.5
## [15] 70.2 70.2 67.4 67.8 72.1 73.0
</code></pre></div></div>

<p>From scanning through these numbers we start getting a rough idea of what the entire list looks like but it is certainly inefficient. We can quickly improve on this approach by creating bins, say by rounding each value to the nearest inch, and reporting the number of individuals in each bin. A plot of these heights is called a histogram</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>We can specify the bins and add better labels in the following way:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bins</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="nf">floor</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="nf">ceiling</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="w">
</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">breaks</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"Height"</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="s2">"Adult men heights"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-histogram-1.png" alt="plot of chunk histogram" /></p>

<p>Showing this plot to the alien is much more informative than showing the numbers. Note that with this simple plot we can approximate the number of individuals in any given interval. For example, there are about 70 individuals over six feet (72 inches) tall.</p>

<p><a name="ecdf"></a></p>

<h1 id="empirical-cummulative-density-function">Empirical Cummulative Density Function</h1>

<p>Although not as popular as the histogram for EDA, the empirical cumulative density function (CDF) shows us the same information and does not require us to define bins. For any number <script type="math/tex">x</script> the empirical CDF reports the proportion of numbers in our list smaller or equal to <script type="math/tex">x</script>. R provides a function that has as out the empirical CDF function. Here:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">myCDF</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ecdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<p>we create a function called <code class="language-plaintext highlighter-rouge">myCDF</code> based on our data <code class="language-plaintext highlighter-rouge">x</code> that can then be used to generate a plot</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##We will evaluate the function at these values:</span><span class="w">
</span><span class="n">xs</span><span class="o">&lt;-</span><span class="n">seq</span><span class="p">(</span><span class="nf">floor</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="nf">ceiling</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span><span class="m">0.1</span><span class="p">)</span><span class="w"> 
</span><span class="c1">### and then plot them:</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">myCDF</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span><span class="n">type</span><span class="o">=</span><span class="s2">"l"</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"x=Height"</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s2">"F(x)"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-unnamed-chunk-4-1.png" alt="plot of chunk unnamed-chunk-4" /></p>

<p><a name="normaldistribution"></a></p>

<h1 id="normal-approximation">Normal approximation</h1>

<p>If instead of the total numbers we report the proportions, then the histogram above can be thought of a probability distribution. The probability distribution we see above approximates one that is very common in a nature: the normal distribution also refereed to as the bell curve or Gaussian distribution. When the histogram of a list of numbers approximates the normal distribution we can use a convenient mathematical formula to approximate the proportion of individuals in any given interval</p>

<script type="math/tex; mode=display">% <![CDATA[
\mbox{Pr}(a < x < b) = \int_a^b \frac{1}{\sqrt{2\pi\sigma^2}} \exp{\left( \frac{-(x-\mu)^2}{2 \sigma^2} \right)} \, dx %]]></script>

<p>Here <script type="math/tex">\mu</script> and <script type="math/tex">\sigma</script> are the mean and standard deviation and we can get them like this:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">mu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">popsd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mean</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="p">))</span><span class="w"> 
</span><span class="n">popsd</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 2.743595
</code></pre></div></div>

<p>Note the <code class="language-plaintext highlighter-rouge">sd</code> function in R gives us a sample estimate of the <script type="math/tex">\sigma</script> as opposed to the population <script type="math/tex">\sigma</script>.</p>

<p>If this approximation holds for our list then the population mean and variance of our list can be used in the formula above. To see this with an example remember that above we noted that 70 individuals or 6% of our population were taller than 6 feet. The normal approximation works well:</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="m">1</span><span class="o">-</span><span class="n">pnorm</span><span class="p">(</span><span class="m">72</span><span class="p">,</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">popsd</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> 
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>## [1] 0.05797647
</code></pre></div></div>

<p>A very useful characteristic of this approximation is that one only needs to know <script type="math/tex">\mu</script> and <script type="math/tex">\sigma</script> to describe the entire distribution. All we really have to tell our alien friend is that heights follow a normal distribution with average height 68’’ and a standard deviation of 3’’. From this we can compute the proportion of individuals in any interval. It is a very compact summary.</p>

<h1 id="qq-plot">QQ-plot</h1>

<p>To corroborate that the normal distribution is in fact a good approximation we can use quantile-quantile plots (QQ-plots). Quantiles are best understood by considering the special case of percentiles. The p-th percentile of a list of a distribution is defined as the number q that is bigger than p% of numbers. For example, the median 50-th percentile is the median. We can compute the percentiles for our list and for the normal distribution</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ps</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span><span class="m">0.99</span><span class="p">,</span><span class="m">0.01</span><span class="p">)</span><span class="w">
</span><span class="n">qs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">quantile</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ps</span><span class="p">)</span><span class="w">
</span><span class="n">normalqs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">qnorm</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">popsd</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">normalqs</span><span class="p">,</span><span class="n">qs</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"Normal percentiles"</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s2">"Height percentiles"</span><span class="p">)</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="c1">##identity line</span><span class="w">
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-unnamed-chunk-7-1.png" alt="plot of chunk unnamed-chunk-7" /> 
Note how close these values are. Also note that we can see these qqplots with less code</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-unnamed-chunk-8-1.png" alt="plot of chunk unnamed-chunk-8" /> 
However, the <code class="language-plaintext highlighter-rouge">qqnorm</code> function plots against a standard normal distribution. This is why the line has slope <code class="language-plaintext highlighter-rouge">popsd(x)</code> and intercept <code class="language-plaintext highlighter-rouge">mean(x)</code></p>

<p>In the example above the points match the line very well. In fact we can run Monte Carlo simulations to see that we see plots like this for data known to be normally distributed</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="m">-1000</span><span class="w">
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w">
</span><span class="n">qqnorm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-unnamed-chunk-9-1.png" alt="plot of chunk unnamed-chunk-9" /></p>

<p>We can also get a sense for how non-normally distributed data looks. Here we generate data from the t-distribution with different degrees of freedom. Note that the smaller the degrees of freedoms the fatter the tails.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dfs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">30</span><span class="p">)</span><span class="w">
</span><span class="n">mypar2</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">df</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">dfs</span><span class="p">){</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rt</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="n">df</span><span class="p">)</span><span class="w">
  </span><span class="n">qqnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xlab</span><span class="o">=</span><span class="s2">"t quantiles"</span><span class="p">,</span><span class="n">main</span><span class="o">=</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"d.f="</span><span class="p">,</span><span class="n">df</span><span class="p">),</span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">-6</span><span class="p">,</span><span class="m">6</span><span class="p">))</span><span class="w">
  </span><span class="n">qqline</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-unnamed-chunk-10-1.png" alt="plot of chunk unnamed-chunk-10" /></p>

<p><a name="boxplots"></a></p>

<h1 id="boxplots">Boxplots</h1>

<p>Data is not always normally distributed. Income is widely cited example. In these cases the average and standard deviation are not necessarily informative since one can’t infer the distribution from just these two numbers. The properties described above are specific to the normal. For example, the normal distribution does not seem to be a good approximation for the direct compensation for 199 United States CEOs in the year 2000</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">hist</span><span class="p">(</span><span class="n">exec.pay</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-unnamed-chunk-11-1.png" alt="plot of chunk unnamed-chunk-11" /></p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">qqnorm</span><span class="p">(</span><span class="n">exec.pay</span><span class="p">)</span><span class="w">
</span><span class="n">qqline</span><span class="p">(</span><span class="n">exec.pay</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-unnamed-chunk-11-2.png" alt="plot of chunk unnamed-chunk-11" /> 
A practical summary is to compute 3 percentiles: 25-th, 50-th (the median) and the 75-th. A boxplots shows these 3 values along with a range calculated as median <script type="math/tex">\pm</script> 1.5 75-th percentiles - 25th-percentile. Values outside this range are shown as points and sometimes refereed to as <em>outliers</em>.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">boxplot</span><span class="p">(</span><span class="n">exec.pay</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="s2">"10,000s of dollars"</span><span class="p">,</span><span class="n">ylim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">400</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p><img src="/book/pages/figure/exploratory_data_analysis_1-unnamed-chunk-12-1.png" alt="plot of chunk unnamed-chunk-12" /></p>

  </div>
</div>


      </div>
      <hr>
      <footer>
        <p><small>
  <!-- start of Karl's footer; modify this part -->

<a href="http://genomicsclass.github.io/book/">PH525x</a>, 
Rafael Irizarry and Michael Love, 
<a href="https://github.com/genomicsclass/labs/blob/master/LICENSE">MIT License</a>

  <!-- end of Karl's footer; modify this part -->
        </small></p>
      </footer>

    </div>

    
  </body>
</html>

